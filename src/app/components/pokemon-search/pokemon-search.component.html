<!-- Search Bar -->
<div class="mb-8 relative">
  <div class="relative">
    <input
      type="text"
      [(ngModel)]="searchQuery"
      (ngModelChange)="onSearchChange($event)"
      placeholder="Search Pokémon by name..."
      class="w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/50 transition-all"
    />
    @if (searchQuery()) {
      <button
        (click)="clearSearch()"
        class="absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 hover:text-white transition-colors"
      >
        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
        </svg>
      </button>
    }
  </div>

  <!-- Search Results Dropdown -->
  @if (searchQuery() && (isSearching() || searchResults().length > 0)) {
    <div class="absolute top-14 left-0 right-0 z-50 bg-slate-800 border border-slate-700 rounded-lg shadow-lg">
      @if (isSearching()) {
        <div class="p-4 text-center text-slate-400">
          <div class="flex items-center justify-center">
            <div class="animate-spin rounded-full h-5 w-5 border-b-2 border-blue-500 mr-2"></div>
            Searching...
          </div>
        </div>
      } @else if (searchResults().length > 0) {
        @for (pokemon of searchResults(); track pokemon.url) {
          <button
            (click)="selectSearchResult(pokemon.name)"
            class="w-full p-4 hover:bg-slate-700 transition-colors text-left border-b border-slate-700 last:border-b-0 flex items-center gap-4"
          >
            <img
              [src]="getPokemonImageUrl(pokemon.url)"
              [alt]="pokemon.name"
              class="w-12 h-12 object-contain"
            />
            <div class="flex-1">
              <h4 class="text-white font-semibold capitalize">{{ pokemon.name }}</h4>
              @if (pokemon.pokemonDetails?.types) {
                <div class="flex gap-2 mt-1">
                  @for (type of pokemon.pokemonDetails?.types; track type.type.name) {
                    <span class="text-xs px-2 py-1 rounded bg-slate-700 text-slate-300 capitalize">
                      {{ type.type.name }}
                    </span>
                  }
                </div>
              }
            </div>
          </button>
        }
      } @else {
        <div class="p-4 text-center text-slate-400">
          No Pokémon found
        </div>
      }
    </div>
  }
</div>
